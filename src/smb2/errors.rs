//! # errors
//!
//! this module exposes all the protocol errors

/**
 * MIT License
 *
 * pavao - Copyright (C) 2021 Christian Visintin
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
extern crate num;
// deps
use std::convert::TryFrom;
use thiserror::Error;

// TODO: this error

/// ## Error
///
/// Describes an error type for
#[derive(Clone, Copy, PartialEq, Eq)]
pub enum Error {
    ServerError(ErrorCode),
}

/// ## ErrorCode
///
/// Describes an error returned in state. For SMB2 the values are listed here:
/// <https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-erref/596a1078-e883-4972-9bbc-49e60bebca55>
#[derive(Clone, Copy, FromPrimitive, PartialEq, Eq)]
pub enum ErrorCode {
    Success = 0x00000000,
    Aborted = 0xffffffff,
    Pending = 0x00000103,
    SmbBadFid = 0x00060001,
    NoMoreFiles = 0x80000006,
    Unsuccessful = 0xC0000001,
    NotImplemented = 0xC0000002,
    InvalidInfoClass = 0xC0000003,
    InfoLengthMismatch = 0xC0000004,
    AccessViolation = 0xC0000005,
    InPageError = 0xC0000006,
    PagefileQuota = 0xC0000007,
    InvalidHandle = 0xC0000008,
    BadInitialStack = 0xC0000009,
    BadInitialPc = 0xC000000A,
    InvalidCid = 0xC000000B,
    TimerNotCanceled = 0xC000000C,
    InvalidParameter = 0xC000000D,
    NoSuchDevice = 0xC000000E,
    NoSuchFile = 0xC000000F,
    InvalidDeviceRequest = 0xC0000010,
    EndOfFile = 0xC0000011,
    WrongVolume = 0xC0000012,
    NoMediaInDevice = 0xC0000013,
    UnrecognizedMedia = 0xC0000014,
    NonexistentSector = 0xC0000015,
    MoreProcessingRequired = 0xC0000016,
    NoMemory = 0xC0000017,
    ConflictingAddresses = 0xC0000018,
    NotMappedView = 0xC0000019,
    UnableToFreeVm = 0xC000001A,
    UnableToDeleteSection = 0xC000001B,
    InvalidSystemService = 0xC000001C,
    IllegalInstruction = 0xC000001D,
    InvalidLockSequence = 0xC000001E,
    InvalidViewSize = 0xC000001F,
    InvalidFileForSection = 0xC0000020,
    AlreadyCommitted = 0xC0000021,
    AccessDenied = 0xC0000022,
    BufferTooSmall = 0xC0000023,
    ObjectTypeMismatch = 0xC0000024,
    NoncontinuableException = 0xC0000025,
    InvalidDisposition = 0xC0000026,
    Unwind = 0xC0000027,
    BadStack = 0xC0000028,
    InvalidUnwindTarget = 0xC0000029,
    NotLocked = 0xC000002A,
    ParityError = 0xC000002B,
    UnableToDecommitVm = 0xC000002C,
    NotCommitted = 0xC000002D,
    InvalidPortAttributes = 0xC000002E,
    PortMessageTooLong = 0xC000002F,
    InvalidParameterMix = 0xC0000030,
    InvalidQuotaLower = 0xC0000031,
    DiskCorruptError = 0xC0000032,
    ObjectNameInvalid = 0xC0000033,
    ObjectNameNotFound = 0xC0000034,
    ObjectNameCollision = 0xC0000035,
    HandleNotWaitable = 0xC0000036,
    PortDisconnected = 0xC0000037,
    DeviceAlreadyAttached = 0xC0000038,
    ObjectPathInvalid = 0xC0000039,
    ObjectPathNotFound = 0xC000003A,
    ObjectPathSyntaxBad = 0xC000003B,
    DataOverrun = 0xC000003C,
    DataLateError = 0xC000003D,
    DataError = 0xC000003E,
    CrcError = 0xC000003F,
    SectionTooBig = 0xC0000040,
    PortConnectionRefused = 0xC0000041,
    InvalidPortHandle = 0xC0000042,
    SharingViolation = 0xC0000043,
    QuotaExceeded = 0xC0000044,
    InvalidPageProtection = 0xC0000045,
    MutantNotOwned = 0xC0000046,
    SemaphoreLimitExceeded = 0xC0000047,
    PortAlreadySet = 0xC0000048,
    SectionNotImage = 0xC0000049,
    SuspendCountExceeded = 0xC000004A,
    ThreadIsTerminating = 0xC000004B,
    BadWorkingSetLimit = 0xC000004C,
    IncompatibleFileMap = 0xC000004D,
    SectionProtection = 0xC000004E,
    EasNotSupported = 0xC000004F,
    EaTooLarge = 0xC0000050,
    NonexistentEaEntry = 0xC0000051,
    NoEasOnFile = 0xC0000052,
    EaCorruptError = 0xC0000053,
    FileLockConflict = 0xC0000054,
    LockNotGranted = 0xC0000055,
    DeletePending = 0xC0000056,
    CtlFileNotSupported = 0xC0000057,
    UnknownRevision = 0xC0000058,
    RevisionMismatch = 0xC0000059,
    InvalidOwner = 0xC000005A,
    InvalidPrimaryGroup = 0xC000005B,
    NoImpersonationToken = 0xC000005C,
    CantDisableMandatory = 0xC000005D,
    NoLogonServers = 0xC000005E,
    NoSuchLogonSession = 0xC000005F,
    NoSuchPrivilege = 0xC0000060,
    PrivilegeNotHeld = 0xC0000061,
    InvalidAccountName = 0xC0000062,
    UserExists = 0xC0000063,
    NoSuchUser = 0xC0000064,
    GroupExists = 0xC0000065,
    NoSuchGroup = 0xC0000066,
    MemberInGroup = 0xC0000067,
    MemberNotInGroup = 0xC0000068,
    LastAdmin = 0xC0000069,
    WrongPassword = 0xC000006A,
    IllFormedPassword = 0xC000006B,
    PasswordRestriction = 0xC000006C,
    LogonFailure = 0xC000006D,
    AccountRestriction = 0xC000006E,
    InvalidLogonHours = 0xC000006F,
    InvalidWorkstation = 0xC0000070,
    PasswordExpired = 0xC0000071,
    AccountDisabled = 0xC0000072,
    NoneMapped = 0xC0000073,
    TooManyLuidsRequested = 0xC0000074,
    LuidsExhausted = 0xC0000075,
    InvalidSubAuthority = 0xC0000076,
    InvalidAcl = 0xC0000077,
    InvalidSid = 0xC0000078,
    InvalidSecurityDescr = 0xC0000079,
    ProcedureNotFound = 0xC000007A,
    InvalidImageFormat = 0xC000007B,
    NoToken = 0xC000007C,
    BadInheritanceAcl = 0xC000007D,
    RangeNotLocked = 0xC000007E,
    DiskFull = 0xC000007F,
    ServerDisabled = 0xC0000080,
    ServerNotDisabled = 0xC0000081,
    TooManyGuidsRequested = 0xC0000082,
    GuidsExhausted = 0xC0000083,
    InvalidIdAuthority = 0xC0000084,
    AgentsExhausted = 0xC0000085,
    InvalidVolumeLabel = 0xC0000086,
    SectionNotExtended = 0xC0000087,
    NotMappedData = 0xC0000088,
    ResourceDataNotFound = 0xC0000089,
    ResourceTypeNotFound = 0xC000008A,
    ResourceNameNotFound = 0xC000008B,
    ArrayBoundsExceeded = 0xC000008C,
    FloatDenormalOperand = 0xC000008D,
    FloatDivideByZero = 0xC000008E,
    FloatInexactResult = 0xC000008F,
    FloatInvalidOperation = 0xC0000090,
    FloatOverflow = 0xC0000091,
    FloatStackCheck = 0xC0000092,
    FloatUnderflow = 0xC0000093,
    IntegerDivideByZero = 0xC0000094,
    IntegerOverflow = 0xC0000095,
    PrivilegedInstruction = 0xC0000096,
    TooManyPagingFiles = 0xC0000097,
    FileInvalid = 0xC0000098,
    AllottedSpaceExceeded = 0xC0000099,
    InsufficientResources = 0xC000009A,
    DfsExitPathFound = 0xC000009B,
    DeviceDataError = 0xC000009C,
    DeviceNotConnected = 0xC000009D,
    DevicePowerFailure = 0xC000009E,
    FreeVmNotAtBase = 0xC000009F,
    MemoryNotAllocated = 0xC00000A0,
    WorkingSetQuota = 0xC00000A1,
    MediaWriteProtected = 0xC00000A2,
    DeviceNotReady = 0xC00000A3,
    InvalidGroupAttributes = 0xC00000A4,
    BadImpersonationLevel = 0xC00000A5,
    CantOpenAnonymous = 0xC00000A6,
    BadValidationClass = 0xC00000A7,
    BadTokenType = 0xC00000A8,
    BadMasterBootRecord = 0xC00000A9,
    InstructionMisalignment = 0xC00000AA,
    InstanceNotAvailable = 0xC00000AB,
    PipeNotAvailable = 0xC00000AC,
    InvalidPipeState = 0xC00000AD,
    PipeBusy = 0xC00000AE,
    IllegalFunction = 0xC00000AF,
    PipeDisconnected = 0xC00000B0,
    PipeClosing = 0xC00000B1,
    PipeConnected = 0xC00000B2,
    PipeListening = 0xC00000B3,
    InvalidReadMode = 0xC00000B4,
    IoTimeout = 0xC00000B5,
    FileForcedClosed = 0xC00000B6,
    ProfilingNotStarted = 0xC00000B7,
    ProfilingNotStopped = 0xC00000B8,
    CouldNotInterpret = 0xC00000B9,
    FileIsADirectory = 0xC00000BA,
    NotSupported = 0xC00000BB,
    RemoteNotListening = 0xC00000BC,
    DuplicateName = 0xC00000BD,
    BadNetworkPath = 0xC00000BE,
    NetworkBusy = 0xC00000BF,
    DeviceDoesNotExist = 0xC00000C0,
    TooManyCommands = 0xC00000C1,
    AdapterHardwareError = 0xC00000C2,
    InvalidNetworkResponse = 0xC00000C3,
    UnexpectedNetworkError = 0xC00000C4,
    BadRemoteAdapter = 0xC00000C5,
    PrintQueueFull = 0xC00000C6,
    NoSpoolSpace = 0xC00000C7,
    PrintCancelled = 0xC00000C8,
    NetworkNameDeleted = 0xC00000C9,
    NetworkAccessDenied = 0xC00000CA,
    BadDeviceType = 0xC00000CB,
    BadNetworkName = 0xC00000CC,
    TooManyNames = 0xC00000CD,
    TooManySessions = 0xC00000CE,
    SharingPaused = 0xC00000CF,
    RequestNotAccepted = 0xC00000D0,
    RedirectorPaused = 0xC00000D1,
    NetWriteFault = 0xC00000D2,
    ProfilingAtLimit = 0xC00000D3,
    NotSameDevice = 0xC00000D4,
    FileRenamed = 0xC00000D5,
    VirtualCircuitClosed = 0xC00000D6,
    NoSecurityOnObject = 0xC00000D7,
    CantWait = 0xC00000D8,
    PipeEmpty = 0xC00000D9,
    CantAccessDomainInfo = 0xC00000DA,
    CantTerminateSelf = 0xC00000DB,
    InvalidServerState = 0xC00000DC,
    InvalidDomainState = 0xC00000DD,
    InvalidDomainRole = 0xC00000DE,
    NoSuchDomain = 0xC00000DF,
    DomainExists = 0xC00000E0,
    DomainLimitExceeded = 0xC00000E1,
    OplockNotGranted = 0xC00000E2,
    InvalidOplockProtocol = 0xC00000E3,
    InternalDbCorruption = 0xC00000E4,
    InternalError = 0xC00000E5,
    GenericNotMapped = 0xC00000E6,
    BadDescriptorFormat = 0xC00000E7,
    InvalidUserBuffer = 0xC00000E8,
    UnexpectedIoError = 0xC00000E9,
    UnexpectedMmCreateErr = 0xC00000EA,
    UnexpectedMmMapError = 0xC00000EB,
    UnexpectedMmExtendErr = 0xC00000EC,
    NotLogonProcess = 0xC00000ED,
    LogonSessionExists = 0xC00000EE,
    RedirectorNotStarted = 0xC00000FB,
    RedirectorStarted = 0xC00000FC,
    StackOverflow = 0xC00000FD,
    NoSuchPackage = 0xC00000FE,
    BadFunctionTable = 0xC00000FF,
    DirectoryNotEmpty = 0xC0000101,
    FileCorruptError = 0xC0000102,
    NotADirectory = 0xC0000103,
    BadLogonSessionState = 0xC0000104,
    LogonSessionCollision = 0xC0000105,
    NameTooLong = 0xC0000106,
    FilesOpen = 0xC0000107,
    ConnectionInUse = 0xC0000108,
    MessageNotFound = 0xC0000109,
    ProcessIsTerminating = 0xC000010A,
    InvalidLogonType = 0xC000010B,
    NoGuidTranslation = 0xC000010C,
    CannotImpersonate = 0xC000010D,
    ImageAlreadyLoaded = 0xC000010E,
    AbiosNotPresent = 0xC000010F,
    AbiosLidNotExist = 0xC0000110,
    AbiosLidAlreadyOwned = 0xC0000111,
    AbiosNotLidOwner = 0xC0000112,
    AbiosInvalidCommand = 0xC0000113,
    AbiosInvalidLid = 0xC0000114,
    AbiosSelectorNotAvailable = 0xC0000115,
    AbiosInvalidSelector = 0xC0000116,
    NoLdt = 0xC0000117,
    InvalidLdtSize = 0xC0000118,
    InvalidLdtOffset = 0xC0000119,
    InvalidLdtDescriptor = 0xC000011A,
    InvalidImageNeFormat = 0xC000011B,
    RxactInvalidState = 0xC000011C,
    RxactCommitFailure = 0xC000011D,
    MappedFileSizeZero = 0xC000011E,
    TooManyOpenedFiles = 0xC000011F,
    Cancelled = 0xC0000120,
    CannotDelete = 0xC0000121,
    InvalidComputerName = 0xC0000122,
    FileDeleted = 0xC0000123,
    SpecialAccount = 0xC0000124,
    SpecialGroup = 0xC0000125,
    SpecialUser = 0xC0000126,
    MembersPrimaryGroup = 0xC0000127,
    FileClosed = 0xC0000128,
    TooManyThreads = 0xC0000129,
    ThreadNotInProcess = 0xC000012A,
    TokenAlreadyInUse = 0xC000012B,
    PagefileQuotaExceeded = 0xC000012C,
    CommitmentLimit = 0xC000012D,
    InvalidImageLeFormat = 0xC000012E,
    InvalidImageNotMz = 0xC000012F,
    InvalidImageProtect = 0xC0000130,
    LogonServerConflict = 0xC0000132,
    TimeDifferenceAtDc = 0xC0000133,
    SynchronizationRequired = 0xC0000134,
    DllNotFound = 0xC0000135,
    OpenFailed = 0xC0000136,
    IoPrivilegeFailed = 0xC0000137,
    OrdinalNotFound = 0xC0000138,
    EntrypointNotFound = 0xC0000139,
    ControlCExit = 0xC000013A,
    LocalDisconnect = 0xC000013B,
    RemoteDisconnect = 0xC000013C,
    RemoteResources = 0xC000013D,
    LinkFailed = 0xC000013E,
    LinkTimeout = 0xC000013F,
    InvalidConnection = 0xC0000140,
    InvalidAddress = 0xC0000141,
    DllInitFailed = 0xC0000142,
    MissingSystemfile = 0xC0000143,
    UnhandledException = 0xC0000144,
    AppInitFailure = 0xC0000145,
    PagefileCreateFailed = 0xC0000146,
    NoPagefile = 0xC0000147,
    InvalidLevel = 0xC0000148,
    WrongPasswordCore = 0xC0000149,
    IllegalFloatContext = 0xC000014A,
    PipeBroken = 0xC000014B,
    RegistryCorrupt = 0xC000014C,
    RegistryIoFailed = 0xC000014D,
    NoEventPair = 0xC000014E,
    UnrecognizedVolume = 0xC000014F,
    SerialNoDeviceInited = 0xC0000150,
    NoSuchAlias = 0xC0000151,
    MemberNotInAlias = 0xC0000152,
    MemberInAlias = 0xC0000153,
    AliasExists = 0xC0000154,
    LogonNotGranted = 0xC0000155,
    TooManySecrets = 0xC0000156,
    SecretTooLong = 0xC0000157,
    InternalDbError = 0xC0000158,
    FullscreenMode = 0xC0000159,
    TooManyContextIds = 0xC000015A,
    LogonTypeNotGranted = 0xC000015B,
    NotRegistryFile = 0xC000015C,
    NtCrossEncryptionRequired = 0xC000015D,
    DomainCtrlrConfigError = 0xC000015E,
    FtMissingMember = 0xC000015F,
    IllFormedServiceEntry = 0xC0000160,
    IllegalCharacter = 0xC0000161,
    UnmappableCharacter = 0xC0000162,
    UndefinedCharacter = 0xC0000163,
    FloppyVolume = 0xC0000164,
    FloppyIdMarkNotFound = 0xC0000165,
    FloppyWrongCylinder = 0xC0000166,
    FloppyUnknownError = 0xC0000167,
    FloppyBadRegisters = 0xC0000168,
    DiskRecalibrateFailed = 0xC0000169,
    DiskOperationFailed = 0xC000016A,
    DiskResetFailed = 0xC000016B,
    SharedIrqBusy = 0xC000016C,
    FtOrphaning = 0xC000016D,
    PartitionFailure = 0xC0000172,
    InvalidBlockLength = 0xC0000173,
    DeviceNotPartitioned = 0xC0000174,
    UnableToLockMedia = 0xC0000175,
    UnableToUnloadMedia = 0xC0000176,
    EomOverflow = 0xC0000177,
    NoMedia = 0xC0000178,
    NoSuchMember = 0xC000017A,
    InvalidMember = 0xC000017B,
    KeyDeleted = 0xC000017C,
    NoLogSpace = 0xC000017D,
    TooManySids = 0xC000017E,
    LmCrossEncryptionRequired = 0xC000017F,
    KeyHasChildren = 0xC0000180,
    ChildMustBeVolatile = 0xC0000181,
    DeviceConfigurationError = 0xC0000182,
    DriverInternalError = 0xC0000183,
    InvalidDeviceState = 0xC0000184,
    IoDeviceError = 0xC0000185,
    DeviceProtocolError = 0xC0000186,
    BackupController = 0xC0000187,
    LogFileFull = 0xC0000188,
    TooLate = 0xC0000189,
    NoTrustLsaSecret = 0xC000018A,
    NoTrustSamAccount = 0xC000018B,
    TrustedDomainFailure = 0xC000018C,
    TrustedRelationshipFailure = 0xC000018D,
    EventlogFileCorrupt = 0xC000018E,
    EventlogCantStart = 0xC000018F,
    TrustFailure = 0xC0000190,
    MutantLimitExceeded = 0xC0000191,
    NetlogonNotStarted = 0xC0000192,
    AccountExpired = 0xC0000193,
    PossibleDeadlock = 0xC0000194,
    NetworkCredentialConflict = 0xC0000195,
    RemoteSessionLimit = 0xC0000196,
    EventlogFileChanged = 0xC0000197,
    NologonInterdomainTrustAc = 0xC0000198,
    NologonWorkstationTrustAc = 0xC0000199,
    NologonServerTrustAccount = 0xC000019A,
    DomainTrustInconsistent = 0xC000019B,
    FsDriverRequired = 0xC000019C,
    NoUserSessionKey = 0xC0000202,
    UserSessionDeleted = 0xC0000203,
    ResourceLangNotFound = 0xC0000204,
    InsuffServerResources = 0xC0000205,
    InvalidBufferSize = 0xC0000206,
    InvalidAddressComponent = 0xC0000207,
    InvalidAddressWildcard = 0xC0000208,
    TooManyAddresses = 0xC0000209,
    AddressAlreadyExists = 0xC000020A,
    AddressClosed = 0xC000020B,
    ConnectionDisconnected = 0xC000020C,
    ConnectionReset = 0xC000020D,
    TooManyNodes = 0xC000020E,
    TransactionAborted = 0xC000020F,
    TransactionTimedOut = 0xC0000210,
    TransactionNoRelease = 0xC0000211,
    TransactionNoMatch = 0xC0000212,
    TransactionResponded = 0xC0000213,
    TransactionInvalidId = 0xC0000214,
    TransactionInvalidType = 0xC0000215,
    NotServerSession = 0xC0000216,
    NotClientSession = 0xC0000217,
    CannotLoadRegistryFile = 0xC0000218,
    DebugAttachFailed = 0xC0000219,
    SystemProcessTerminated = 0xC000021A,
    DataNotAccepted = 0xC000021B,
    NoBrowserServersFound = 0xC000021C,
    VdmHardError = 0xC000021D,
    DriverCancelTimeout = 0xC000021E,
    ReplyMessageMismatch = 0xC000021F,
    MappedAlignment = 0xC0000220,
    ImageChecksumMismatch = 0xC0000221,
    LostWritebehindData = 0xC0000222,
    ClientServerParametersInv = 0xC0000223,
    PasswordMustChange = 0xC0000224,
    NotFound = 0xC0000225,
    NotTinyStream = 0xC0000226,
    RecoveryFailure = 0xC0000227,
    StackOverflowRead = 0xC0000228,
    FailCheck = 0xC0000229,
    DuplicateObjectid = 0xC000022A,
    ObjectidExists = 0xC000022B,
    ConvertToLarge = 0xC000022C,
    Retry = 0xC000022D,
    FoundOutOfScope = 0xC000022E,
    AllocateBucket = 0xC000022F,
    PropsetNotFound = 0xC0000230,
    MarshallOverflow = 0xC0000231,
    InvalidVariant = 0xC0000232,
    DomainControllerNotFound = 0xC0000233,
    AccountLockedOut = 0xC0000234,
    HandleNotClosable = 0xC0000235,
    ConnectionRefused = 0xC0000236,
    GracefulDisconnect = 0xC0000237,
    AddressAlreadyAssociated = 0xC0000238,
    AddressNotAssociated = 0xC0000239,
    ConnectionInvalid = 0xC000023A,
    ConnectionActive = 0xC000023B,
    NetworkUnreachable = 0xC000023C,
    HostUnreachable = 0xC000023D,
    ProtocolUnreachable = 0xC000023E,
    PortUnreachable = 0xC000023F,
    RequestAborted = 0xC0000240,
    ConnectionAborted = 0xC0000241,
    BadCompressionBuffer = 0xC0000242,
    UserMappedFile = 0xC0000243,
    AuditFailed = 0xC0000244,
    TimerResolutionNotSet = 0xC0000245,
    ConnectionCountLimit = 0xC0000246,
    LoginTimeRestriction = 0xC0000247,
    LoginWkstaRestriction = 0xC0000248,
    ImageMpUpMismatch = 0xC0000249,
    InsufficientLogonInfo = 0xC0000250,
    BadDllEntrypoint = 0xC0000251,
    BadServiceEntrypoint = 0xC0000252,
    LpcReplyLost = 0xC0000253,
    IpAddressConflict1 = 0xC0000254,
    IpAddressConflict2 = 0xC0000255,
    RegistryQuotaLimit = 0xC0000256,
    PathNotCovered = 0xC0000257,
    NoCallbackActive = 0xC0000258,
    LicenseQuotaExceeded = 0xC0000259,
    PwdTooShort = 0xC000025A,
    PwdTooRecent = 0xC000025B,
    PwdHistoryConflict = 0xC000025C,
    PlugplayNoDevice = 0xC000025E,
    UnsupportedCompression = 0xC000025F,
    InvalidHwProfile = 0xC0000260,
    InvalidPlugplayDevicePath = 0xC0000261,
    DriverOrdinalNotFound = 0xC0000262,
    DriverEntrypointNotFound = 0xC0000263,
    ResourceNotOwned = 0xC0000264,
    TooManyLinks = 0xC0000265,
    QuotaListInconsistent = 0xC0000266,
    FileIsOffline = 0xC0000267,
    VolumeDismounted = 0xC000026E,
    NotAReparsePoint = 0xC0000275,
    StoppedOnSymlink = 0x8000002d,
}

impl TryFrom<u32> for ErrorCode {
    type Error = &'static str;

    fn try_from(status: u32) -> Result<Self, Self::Error> {
        match num::FromPrimitive::from_u32(status) {
            Some(err) => Ok(err),
            None => Err("Unknown status code"),
        }
    }
}
